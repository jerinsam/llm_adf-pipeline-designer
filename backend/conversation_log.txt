{'pipeline_flow': {'nodes': [{'id': 'ls_mysql_sqlserver', 'type': 'linked_service', 'name': 'ls_mysql_sqlserver', 'label': 'MySQL Linked Service'}, {'id': 'ls_sqlserver_mysql', 'type': 'linked_service', 'name': 'ls_sqlserver_mysql', 'label': 'SQL Server Linked Service'}, {'id': 'ds_mysql_source', 'type': 'dataset', 'name': 'ds_mysql_source', 'label': 'MySQL Table Dataset'}, {'id': 'ds_sqlserver_sink', 'type': 'dataset', 'name': 'ds_sqlserver_sink', 'label': 'SQL Server Table Dataset'}, {'id': 'ds_sqlserver_tablelist', 'type': 'dataset', 'name': 'ds_sqlserver_tablelist', 'label': 'SQL Server Table List Dataset'}, {'id': 'lookup_tablelist', 'type': 'activity', 'name': 'LookupTableList', 'label': 'Lookup Tables to Copy'}, {'id': 'foreach_tables', 'type': 'activity', 'name': 'ForEachTables', 'label': 'ForEach Table Loop'}, {'id': 'copy_activity', 'type': 'activity', 'name': 'CopyData', 'label': 'Copy Data Activity'}], 'edges': [{'id': 'edge_1', 'source': 'ls_mysql_sqlserver', 'target': 'ds_mysql_source', 'label': 'provides connection'}, {'id': 'edge_2', 'source': 'ls_sqlserver_mysql', 'target': 'ds_sqlserver_sink', 'label': 'provides connection'}, {'id': 'edge_3', 'source': 'ls_sqlserver_mysql', 'target': 'ds_sqlserver_tablelist', 'label': 'provides connection'}, {'id': 'edge_4', 'source': 'ds_sqlserver_tablelist', 'target': 'lookup_tablelist', 'label': 'input dataset'}, {'id': 'edge_5', 'source': 'lookup_tablelist', 'target': 'foreach_tables', 'label': 'passes table list'}, {'id': 'edge_6', 'source': 'foreach_tables', 'target': 'copy_activity', 'label': 'iterates over'}, {'id': 'edge_7', 'source': 'ds_mysql_source', 'target': 'copy_activity', 'label': 'source for copy'}, {'id': 'edge_8', 'source': 'ds_sqlserver_sink', 'target': 'copy_activity', 'label': 'sink for copy'}]}, 'json_configs': {'linked_services': [{'name': 'ls_mysql_sqlserver', 'type': 'Microsoft.DataFactory/factories/linkedservices', 'properties': {'type': 'MySql', 'typeProperties': {'connectionString': 'mysql-connection-string'}}}, {'name': 'ls_sqlserver_mysql', 'type': 'Microsoft.DataFactory/factories/linkedservices', 'properties': {'type': 'SqlServer', 'typeProperties': {'connectionString': 'sqlserver-connection-string'}}}], 'datasets': [{'name': 'ds_mysql_source', 'type': 'Microsoft.DataFactory/factories/datasets', 'properties': {'type': 'MySqlTable', 'linkedServiceName': {'referenceName': 'ls_mysql_sqlserver', 'type': 'LinkedServiceReference'}, 'typeProperties': {'tableName': {'value': '@item().SourceTable', 'type': 'Expression'}}}}, {'name': 'ds_sqlserver_sink', 'type': 'Microsoft.DataFactory/factories/datasets', 'properties': {'type': 'SqlServerTable', 'linkedServiceName': {'referenceName': 'ls_sqlserver_mysql', 'type': 'LinkedServiceReference'}, 'typeProperties': {'tableName': {'value': '@item().TargetTable', 'type': 'Expression'}}}}, {'name': 'ds_sqlserver_tablelist', 'type': 'Microsoft.DataFactory/factories/datasets', 'properties': {'type': 'SqlServerTable', 'linkedServiceName': {'referenceName': 'ls_sqlserver_mysql', 'type': 'LinkedServiceReference'}, 'typeProperties': {'tableName': 'dbo.TableList'}}}], 'pipeline': {'name': 'pl_mysql_to_sqlserver_dynamic', 'type': 'Microsoft.DataFactory/factories/pipelines', 'properties': {'activities': [{'name': 'LookupTableList', 'type': 'Lookup', 'typeProperties': {'source': {'type': 'SqlSource', 'sqlReaderQuery': 'SELECT SourceTable, TargetTable FROM dbo.TableList'}, 'dataset': {'referenceName': 'ds_sqlserver_tablelist', 'type': 'DatasetReference'}, 'firstRowOnly': False}}, {'name': 'ForEachTables', 'type': 'ForEach', 'dependsOn': [{'activity': 'LookupTableList', 'dependencyConditions': ['Succeeded']}], 'typeProperties': {'items': {'value': "@activity('LookupTableList').output.value", 'type': 'Expression'}, 'isSequential': False, 'activities': [{'name': 'CopyData', 'type': 'Copy', 'inputs': [{'referenceName': 'ds_mysql_source', 'type': 'DatasetReference', 'parameters': {'SourceTable': '@item().SourceTable'}}], 'outputs': [{'referenceName': 'ds_sqlserver_sink', 'type': 'DatasetReference', 'parameters': {'TargetTable': '@item().TargetTable'}}], 'typeProperties': {'source': {'type': 'MySqlSource'}, 'sink': {'type': 'SqlSink'}}}]}}]}}}, 'explanation': 'This dynamic Azure Data Factory pipeline copies data from MySQL to SQL Server by first performing a Lookup activity on a SQL Server table that lists the source (MySQL) and target (SQL Server) tables. The Lookup output feeds a ForEach loop that iterates through table pairs, executing a Copy activity per table. Dataset and Linked Service parameters ensure each table identified in the configuration is dynamically processed per ADF best practices.'}
